{% extends 'muxic/theme.html' %}
{% block title %} MuXic {% endblock title %}
{% load staticfiles %}

{% block body %}
    <div class="container">
        <div class="row" id="TopDetail">
            <div class="col-md-9">
                <h3 style="margin-left: 5%; color: #ffffff">{{ song.title }} - {{ song.artist }}</h3>
                <h5 style="margin-left: 5%; color: #ffffff">{{ song.genre }}</h5>
            </div>
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-12">
                        <div id="mp3_player">
                            <canvas id="analyser_render"></canvas>
                            <div id="audio_box"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel panel-body" id="Bottom">
            <br>
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-9" id="left_song">
                        <div class="col-md-3">
                            <img src="{{ song.logo.url }}" id="UploadPic2">
                        </div>
                        <div class="row-md-6">
                            {% if user.is_authenticated %}
                                {% if is_favorite == True %}
                                    <form action="{% url 'muxic:unfavorite' song.id %}" method="get"
                                          style="display: inline">
                                        {% csrf_token %}
                                        <input type="hidden" name="song_id" value="{{ song.id }}"/>
                                        <input type="hidden" name="path" value="{{ request.path }}">
                                        <button type="submit" class="btn btn-default btn-sm">
                                            <span class="glyphicon glyphicon-circle-arrow-down"> Unfavorite</span>
                                        </button>
                                    </form>
                                {% else %}
                                    <form action="{% url 'muxic:favorite' song.id %}" method="get"
                                          style="display: inline">
                                        {% csrf_token %}
                                        <input type="hidden" name="song_id" value="{{ song.id }}"/>
                                        <input type="hidden" name="path" value="{{ request.path }}">
                                        <button type="submit" class="btn btn-default btn-sm">
                                            <span class="glyphicon glyphicon-circle-arrow-up"> Favorite</span>
                                        </button>
                                        <label>{{ song.favorite.all.count }}</label>
                                    </form>
                                {% endif %}
                            {% else %}
                                <button type="submit" class="btn btn-default btn-sm">
                                    <span class="glyphicon glyphicon-circle-arrow-up"><a href="{% url 'muxic:login' %}">Favorite </a></span>
                                </button>
                            {% endif %}
                        </div>
                        <div class="col-md-9" style="border-left: 1px solid #9d9d9d">
                            <div class="col-md-12">
                                <h3>Lyrics:</h3>
                                <div id="Lyric_feild">
                                    {{ song.lyric | linebreaksbr }}
                                </div>
                            </div>
                            <div class="col-md-12">
                                <h3>Bình luận: </h3>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="col-md-9">
                            <h4>Bài hát kế tiếp</h4>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn" style="margin-top: 2px">Tất cả</button>
                        </div>
                    </div>
                </div>
                <br>
            </div>
        </div>
    </div>
    <script>
        var audio = new Audio();
        audio.src = '{{ song.file.url }}';
        audio.controls = true;
        audio.loop = true;
        audio.autoplay = true;
    </script>

{% endblock body %}